<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 2.0.0-M13 from target/generated-site/markdown/index.md at 2024-01-01
 | Rendered using Apache Maven Fluido Skin 2.0.0-M8
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 2.0.0-M13" />
    <title>stringhold – stringhold: A java.lang.String holder</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-2.0.0-M8.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-2.0.0-M8.min.js"></script>
  </head>
  <body>
    <a class="github-fork-ribbon right-top" href="https://github.com/kohlschutter/stringhold" data-ribbon="Fork me on GitHub">Fork me on GitHub</a>
    <div class="container-fluid container-fluid-top">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h1>stringhold — A java.lang.String holder</h1></div></div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2024-01-01<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.0.2-SNAPSHOT</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Overview</li>
    <li class="active"><a>Welcome</a></li>
   <li class="nav-header">Reference</li>
    <li><a href="stringhold-common/apidocs/index.html">Common API Javadoc</a></li>
    <li><a href="stringhold-common/xref/index.html">Common Source xref</a></li>
    <li><a href="stringhold-common/xref-test/index.html">Common Test xref</a></li>
    <li><a href="stringhold-codecoverage/jacoco-aggregate/index.html">Code Coverage</a></li>
   <li class="nav-header">Modules</li>
    <li><a href="stringhold-common/index.html">stringhold-common</a></li>
    <li><a href="stringhold-liqp/index.html">stringhold-liqp</a></li>
    <li><a href="stringhold-codecoverage/index.html">stringhold-codecoverage</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html"><span class="icon-chevron-down"></span>Project Information</a>
     <ul class="nav nav-list">
      <li><a href="dependencies.html">Dependencies</a></li>
      <li><a href="dependency-convergence.html">Dependency Convergence</a></li>
      <li><a href="dependency-info.html">Dependency Information</a></li>
      <li><a href="dependency-management.html">Dependency Management</a></li>
      <li><a href="distribution-management.html">Distribution Management</a></li>
      <li class="active"><a>About</a></li>
      <li><a href="issue-management.html">Issue Management</a></li>
      <li><a href="licenses.html">Licenses</a></li>
      <li><a href="modules.html">Project Modules</a></li>
      <li><a href="plugin-management.html">Plugin Management</a></li>
      <li><a href="plugins.html">Plugins</a></li>
      <li><a href="scm.html">Source Code Management</a></li>
      <li><a href="summary.html">Summary</a></li>
      <li><a href="team.html">Team</a></li>
     </ul></li>
    <li><a href="project-reports.html"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="https://maven.apache.org/" class="builtBy" target="_blank"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn" class="span10">
<section><section><section>
<h3>stringhold: A java.lang.String holder</h3></section></section></section><section>
<h1>stringhold</h1>
<p>Concatenating large Strings in Java, potentially with deep hierarchies, with inputs from different sources (local or network), etc., can be unnecessarily complex:</p>
<ul>

<li>Even with StringBuilders, text gets copied around multiple times</li>
<li>Character buffers get reallocated over and over</li>
<li>A missing input fragment blocks the assembly of the full output</li>
<li>The output is written to a stream, so why did we assemble it to String in the first place?</li>
<li>The output is being assembled and eventually we realize it's too long</li>
<li>We don't realize we ever only need the first line of the 1 megabyte output, but we still create the full thing, involving complex computations</li>
<li>and so on</li>
</ul>
<p><strong>stringhold</strong> comes to the rescue.</p>
<p>Stringhold provides classes replacing or improving the functionality of the following typical Java classes:</p>
<ul>

<li>String</li>
<li>CharSequence</li>
<li>Reader</li>
<li>Appendable</li>
<li>StringBuilder</li>
<li>StringBuffer</li>
<li>Writer</li>
</ul><section>
<h2>StringHolder API</h2>
<p>A <code>StringHolder</code> is something <em>holding</em> data that may turn into a String. This can simply be a String <em>itself</em>, something that can <em>assemble</em> a String from its own state, or something that gets a String <em>supplied</em> from somewhere else (e.g., a <code>Supplier&lt;String&gt;</code>).</p>
<p>The <code>StringHolder</code> is a <code>CharSequence</code>, and calling <code>#toString()</code> will yield the string it holds. All other methods, like <code>#length()</code>, <code>#charAt</code>, <code>#subSequence</code> etc. work the way you expect it. In addition, you can all <code>#toReader()</code> to wrap the contents as a <code>java.io.Reader</code>, and you can call <code>#appendTo(Appendable)</code> to write the contents to some other <code>Appendable</code>.</p>
<p>If you want to concatenate several <code>StringHolders</code>, very much like <code>StringBuilder</code>, you can use a <code>StringHolderSequence</code>, which by itself also is an <code>Appendable</code>, so you can also append Strings directly.</p>
<p>You can use a <code>Reader</code> source as a supplying source through the <code>ReaderStringHolder</code> subclass.</p>
<p>You can also build your own StringHolder subclass, if you want to.</p></section><section>
<h2>The Twist</h2>
<p>All the operations listed above may in fact never create a String or concatenate them. If all that you need is to copy data from a Reader to a Writer, there is no need to construct a single String from it!</p>
<p><strong>stringhold</strong> takes great care of delaying the materialization of String instances from input data as much as possible.</p></section><section>
<h2>Relaxing assumptions</h2>
<p>Often, a criterion such as &#x201c;too long&#x201d; doesn't require to know the exact length of something. It's enough that we know we've hit a certain minimum length.</p>
<p>Also, when estimating buffer sizes, a minimum is handy, but so is an <em>expected length</em>, even though that may not be as clearly defined as a minimum.</p>
<p>Lastly, sometimes we know the exact length but not the content.</p>
<p><code>StringHolder</code> instances can use this information for typical operations such as:</p>
<ul>

<li><code>#equals(Object)</code> checks (if a minimum length of the other object exceeds our own length, it cannot be a match).</li>
<li><code>#isEmpty()</code> checks (a minimum length of 1 is sufficient to rule that out)</li>
</ul></section><section>
<h2>Exceptions and error conditions</h2>
<p><strong>stringhold</strong> can handle situations where the Java API does not expect an <code>IOException</code> to be thrown, but it may still arise from within some code, for example, when assembling a String from a <code>Supplier</code> or <code>Reader</code> for use in <code>toString()</code> or when appending somewhere else.</p>
<p>The exception can either be wrapped in an <code>IllegalStateException</code> or the output can be augmented (e.g., just flushed, replaced with an empty string if possible, or appending the error message or the full stack trace for debugging).</p>
<p>In addition, <code>StringHolder</code> supports a <code>checkError()</code> method to indicate that some constraints were violated.</p></section><section>
<h2>StringHolderScope</h2>
<p>A set of StringHolders can be associated with a <code>StringHolderScope</code>, which receives callbacks upon events regarding these <code>StringHolder</code> instances. Such scopes can be used to implement quota checks and error listeners, for example.</p></section><section>
<h2>Modern Java</h2>
<p><strong>stringhold</strong> is fully compatible with Java 8 and above. Thanks to a Multirelease jar structure, it can optimize the use of Java methods introduced in newer Java releases whenever possible, such as <code>CharSequence#isEmpty()</code> &#x2014; without complicating its own public API.</p></section><section>
<h2>Code Quality</h2>
<p>This project currently maintains a <a href="https://kohlschutter.github.io/stringhold/stringhold-codecoverage/jacoco-aggregate/index.html" class="externalLink">100% code coverage</a> policy.</p>
<p>This is one of the projects where this makes actual sense.</p>
<p>The <strong>stringhold</strong> API is expected to not have breaking changes across minor and patch releases. Changes in behavior are possible but should be clearly marked in the changelog.</p></section></section><section>
<h1>Usage Examples</h1><section>
<h2>The Basics</h2>
<p>A StringHolder using a String directly:</p>

<div class="verbatim">
<pre><code>StringHolder h = StringHolder.withContent(&quot;Some string&quot;);
h.isString(); // always true

h.toString(); // simply returns the associated string.
</code></pre></div>
<p>A StringHolder using a String supplier:</p>

<div class="verbatim">
<pre><code>StringHolder h = StringHolder.withSupplier(() -&gt; &quot;Some string&quot;);
h.isString(); // not true yet

h.toString(); // calls Supplier.get()
h.isString(); // now true

h.toString(); // doesn't Supplier.get() a second time, string is cached
</code></pre></div>
<p>A StringHolder using a String supplier and some length constraints:</p>

<div class="verbatim">
<pre><code>StringHolder h = StringHolder.withSupplierMinimumAndExpectedLength(5, 20, () -&gt; &quot;Some string&quot;);
h.isEmpty(); // false because we claim the string is at least 5 characters long
h.isString(); // not true yet
</code></pre></div>
<p>A StringHolder that reads contents from a function that supplies StringReader instances:</p>

<div class="verbatim">
<pre><code>StringHolder h = StringHolder.withReaderSupplier(() -&gt; new StringReader(&quot;hello&quot;), (
    e) -&gt; IOExceptionHandler.ExceptionResponse.ILLEGAL_STATE);
</code></pre></div>
<p>A sequence of String(Holder)s, some are nested:</p>

<div class="verbatim">
<pre><code>StringHolderSequence seq = StringHolder.newSequence();
seq.append(&quot;Hello&quot;);
seq.append(' ');
seq.append(StringHolder.newSequence().append(StringHolder.withSupplier(() -&gt; &quot;World&quot;));

// Append to a writer
try (Writer out = new FileWriter(new File(&quot;/tmp/out&quot;))) {
	seq.appendTo(out);
}

seq.toString(); // &quot;Hello World&quot;
</code></pre></div>
<p>A sequence of String(Holder)s that can be assembled/appended out of order via scatter-gatter (speed up overall assembly time through parallelization):</p>

<div class="verbatim">
<pre><code>StringHolderSequence seq = StringHolder.newAsyncSequence();
seq.append(veryComplexStringHolder);
seq.append(anotherStringHolder);

// seq.toString() / seq.appendTo() may internally serialize the second StringHolder first.
// The final order is still guaranteed to be correct.
// This may save time at the cost of constructing temporary StringBuilders.
</code></pre></div>
<p>You can also define a conditional StringHolder, which may be defined but later excluded if a condition is not met:</p>

<div class="verbatim">
<pre><code>StringHolder seq = StringHolder.withContent(&quot;Hello&quot;, //
   StringHolder.withConditionalStringHolder(StringHolder.withContent(&quot; World&quot;), (o) -&gt; {
     return checkIfIncluded(o); // false: exclude; true: include
   }));
seq.toString() // returns &quot;Hello&quot; or &quot;Hello World&quot;, depending on checkIfIncluded
</code></pre></div></section><section>
<h2>The full API</h2>
<ul>

<li><a href="https://kohlschutter.github.io/stringhold/stringhold-common/apidocs/index.html" class="externalLink">API JavaDoc</a></li>
<li><a href="https://kohlschutter.github.io/stringhold/stringhold-common/xref/index.html" class="externalLink">Source code</a></li>
<li><a href="https://kohlschutter.github.io/stringhold/stringhold-common/xref-test/index.html" class="externalLink">Test code</a></li>
<li><a href="https://kohlschutter.github.io/stringhold/stringhold-codecoverage/jacoco-aggregate/index.html" class="externalLink">Code coverage</a></li>
<li><a href="https://kohlschutter.github.io/stringhold/" class="externalLink">Project website</a></li>
</ul></section><section>
<h2>Benchmarks</h2>
<p>TBD</p></section><section>
<h2>Future Improvements</h2>
<ul>

<li>Add optimizations for the <code>IntStream</code> API</li>
</ul></section><section>
<h2>Frequently Asked Questions</h2>
<p>Q: Is this an accidental implementation of half of Lisp?</p>
<p>A: Maybe.</p></section><section>
<h2>Installation</h2><section>
<h3>Maven</h3>
<p>Add the following dependency:</p>

<div class="verbatim">
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;com.kohlschutter.stringhold&lt;/groupId&gt;
    &lt;artifactId&gt;stringhold-common&lt;/artifactId&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre></div></section><section>
<h3>Gradle</h3>

<div class="verbatim">
<pre><code>dependencies {
    implementation 'com.kohlschutter.stringhold:stringhold-common:1.0.0'
}
</code></pre></div></section></section><section>
<h2>Building from source</h2>
<p>You currently need Maven or Eclipse with m2e, and Java 15 or later. Just run:</p>

<div class="verbatim">
<pre><code>mvn clean install
</code></pre></div>
<p>To reformat code, which simplifies pull requests and restores general sanity, use:</p>

<div class="verbatim">
<pre><code>mvn process-sources -Preformat
</code></pre></div></section></section><section>
<h1>Changelog</h1><section><section>
<h3><em>(2024-XX-XX)</em> *<em>stringhold 1.0.2</em></h3>
<ul>

<li>Add indexOf</li>
</ul></section><section>
<h3><em>(2023-12-11)</em> *<em>stringhold 1.0.1</em></h3>
<ul>

<li>Fix liqp dependency</li>
</ul></section><section>
<h3><em>(2023-12-10)</em> <strong>stringhold 1.0.0</strong></h3>
<ul>

<li>Initial release</li>
</ul></section></section></section><section>
<h1>Legal Notices</h1>
<p>Copyright 2022, 2023 Christian Kohlschuetter <a href="mailto:christian@kohlschutter.com" class="externalLink">christian@kohlschutter.com</a></p>
<p>SPDX-License-Identifier: Apache-2.0
See NOTICE and LICENSE for license details.</p></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
<p id="giscus-parent" style="margin-top:20pt;padding-top:20pt;border-top:thin solid #bbb;">
        <script src="https://giscus.app/client.js"
          data-repo="kohlschutter/stringhold"
          data-repo-id="MDEwOlJlcG9zaXRvcnkyNzA2NDIwMQ=="
          data-category="Giscus"
          data-category-id="DIC_kwDOAZz3ic4CQT9j"
          data-mapping="pathname"
          data-reactions-enabled="1"
          data-emit-metadata="0"
          data-input-position="bottom"
          data-theme="light"
          data-lang="en"
          data-loading="lazy"
          crossorigin="anonymous"
          async="async">
        </script>
        <small>
          Discussions widget provided by giscus.app —
          <a
            href="https://github.com/giscus/giscus/blob/main/PRIVACY-POLICY.md"
            target="_top">
            giscus.app privacy policy
          </a> —
          <a href="https://docs.github.com/en/site-policy/github-terms/github-community-guidelines">
          GitHub Community Guidelines
          </a>
        </small>
      </p>
      <script><!--
      document.addEventListener("DOMContentLoaded", function(event) {
        document.getElementById("bodyColumn").appendChild(document.getElementById("giscus-parent"));
      });
      // --></script>
      <p>Copyright 2022
         <a href="https://www.kohlschutter.com/">Kohlschütter Search Intelligence</a>
      </p>
        </div>
      </div>
    </footer>
<script>
  if(anchors) {
    anchors.add();
  }
</script>
  </body>
</html>